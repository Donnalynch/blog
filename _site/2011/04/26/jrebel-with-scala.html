<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <link href="/css/site.css" type="text/css" rel="stylesheet"/>
        <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
        <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
        <title>(think) - Incremental development with Scala and JRebel</title>

        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-22917580-1']);
            _gaq.push(['_trackPageview']);

            (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();

        </script>
    </head>

    <body>
        <div id="page">
            <div id="content">
                <div id="header">
                    <h1>(think)</h1>
                    <p class="comment">/** An online novel about the Source, the Force, the real life and everything
                    in between...**/</p>
                </div>
                <div id="middle">
                    <div id="menu">
                        <ul id="list-nav">
                            <li><a href="/index.html">Home</a></li>
                            <li><a href="/archive.html">Archive</a></li>
                            <li><a href="/projects.html">Projects</a></li>
                            <li><a href="/about.html">About</a></li>
                            <li><a href="/contacts.html">Contacts</a></li>
                        </ul>
                    </div>
                    <div id="content">
                        <div id="post">
    <h2 class="title">Incremental development with Scala and JRebel</h2>
    <p>One of the things I love most about Lisp development is the ability to develop applications in an incremental interactive manner - you write one function, compile it, load into your current REPL session, make some adjustments and repeat this process until you get satisfactory results. You never stop to compile your project, you never have to restart your application server. Without those distractions it&#8217;s easier to maintain your concentration and to remain in the <em>flow</em>.</p>

<p>With languages like Scala and Java, however, you cannot do this - at least without a bit of external help. This help comes in the form of an application called <a href='http://www.zeroturnaround.com/jrebel/'>JRebel</a>, which basically reloads the classes in your program as you make changes to them and recompile them. JRebel is a commercial application and generally you have to pay to use it&#8230; unless you want to you use it for Scala development, that is. ZeroTurnaround(the company that makes JRebel) offers <a href='http://sales.zeroturnaround.com/wp-content/themes/zeroturnaround4.0/modals/applyForLicense.php'>free licences to Scala developers</a> and if you&#8217;re one of them you should definitely get one.</p>

<p>Installing JRebel is trivial - generally you have to only extract a zip file(or use an installer) somewhere and drop in the JRebel folder the licence file that they have e-mail you. Afterwards you simply have to integrate JRebel with your build system. JRebel can also be integrated with IDEs, but I want cover this here. I use mostly <a href='http://maven.apache.org'>Maven 3</a> and <a href='http://code.google.com/p/simple-build-tool/'>SBT</a> so I&#8217;ll show you what to do for them. With Maven you have to add the following to the <em>$MAVEN_OPTS</em> environmental variable:</p>
<div class='highlight'><pre><code class='console'><span class='go'>export MAVEN_OPTS=-noverify -javaagent:/home/bozhidar/work/jrebel/jrebel.jar</span>
</code></pre>
</div>
<p>Since most people use JRebel for web development to avoid the need to restart their application containers and Scala&#8217;s most prominent framework is <a href='http://liftweb.net'>Lift</a> you&#8217;d probably want to enable the JRebel Lift plug-in as well:</p>
<div class='highlight'><pre><code class='console'><span class='go'>export MAVEN_OPTS=-noverify -javaagent:/home/bozhidar/work/jrebel/jrebel.jar</span>
<span class='go'> -Drebel.lift_plugin=true</span>
</code></pre>
</div>
<p>Stick this in your shell&#8217;s init file and source it to make it available in the shell.</p>

<p>Now when you start your web app with</p>
<div class='highlight'><pre><code class='console'><span class='go'>mvn jetty:run</span>
</code></pre>
</div>
<p>And the continuous Scala compilation with</p>
<div class='highlight'><pre><code class='console'><span class='go'>mvn scala:cc</span>
</code></pre>
</div>
<p>The compiler with pickup the changes you made and JRebel will reload the changed classes behind the scenes. The development process this way starts to feel a bit like using a scripting language such as Ruby or PHP.</p>

<p>If you&#8217;re using SBT you should modify the sbt startup script to include the same options that I mentioned in the section about Maven configuration. Mine sbt script looks like this:</p>
<div class='highlight'><pre><code class='console'><span class='gp'>#</span>!/bin/bash

<span class='go'>java -noverify -javaagent:/home/bozhidar/work/jrebel/jrebel.jar</span>
<span class='go'> -Drebel.lift_plugin=true -XX:+CMSClassUnloadingEnabled</span>
<span class='go'> -XX:MaxPermSize=512m -Xmx512M -Xss2M -jar `dirname $0`/sbt-launch.jar</span>
<span class='go'> &quot;$@&quot;</span>
</code></pre>
</div>
<p>Another use for JRebel is the Scala REPL itself. When you start the REPL from inside SBT for instance with the command:</p>
<div class='highlight'><pre><code class='console'><span class='go'>sbt console</span>
</code></pre>
</div>
<p>changes to the imported classes will be reflected automatically without the need to do a <em>:replay</em> or restart the REPL - something reminiscent of the interactive Lisp programming I mentioned earlier.</p>

<p>So what are you waiting for? Go grab JRebel and speed up your Scala development process.</p>
    <div style="font-style: italic; color: #7f9f7f;">Posted on 26 Apr 2011 by Bozhidar.</div>
    <hr />
    <div id="disqus">
        <div id="disqus_thread"></div>
        <script type="text/javascript" src="http://disqus.com/forums/iteration-next/embed.js"></script>
        <noscript><a href="http://iteration-next.disqus.com/?url=ref">View the discussion thread.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
</div>

                    </div>
                </div>
                <div id="footer">
                    <p>Copyright &copy; 2010-2011 <a href="mailto:bozhidar.batsov@gmail.com">Bozhidar Batsov</a>. All Rights Reserved.</p>
                </div>
            </div>
            <div id="sidebar">
                <div id="twitter">
                    <script src="http://widgets.twimg.com/j/2/widget.js" type="text/javascript"></script>
                    <script type="text/javascript">
                        new TWTR.Widget({
                        version: 2,
                        type: 'profile',
                        rpp: 4,
                        interval: 6000,
                        width: 250,
                        height: 300,
                        theme: {
                        shell: {
                        background: '#333333',
                        color: '#ffffff'
                        },
                        tweets: {
                        background: '#000000',
                        color: '#ffffff',
                        links: '#4aed05'
                        }
                        },
                        features: {
                        scrollbar: false,
                        loop: false,
                        live: false,
                        hashtags: true,
                        timestamp: true,
                        avatars: false,
                        behavior: 'all'
                        }
                        }).render().setUser('bbatsov').start();
                    </script>
                </div>
            </div>
        </div>
    </body>
</html>
